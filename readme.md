# Тренировка модели YOLO

## Работа с git в VSCode

https://www.youtube.com/watch?v=bfJQDEXzoT0

## Запуск YOLO на видеокарте (Windows)

### Драйверы Nvidia

Проверить версию драйвера консольной командой nvidia-smi, будет выведена версия драйвера
и максимальная поддерживаемая версия CUDA:

    +-----------------------------------------------------------------------------------------+
    | NVIDIA-SMI 576.52                 Driver Version: 576.52         CUDA Version: 12.9     |
    |-----------------------------------------+------------------------+----------------------+

Если в результате выполнения выведется `"nvidia-smi" не является внутренней или внешней командой, исполняемой программой или пакетным файлом.`, значит драйвер не установлен. 

Ссылка на последнюю версию драйвера:

https://www.nvidia.com/en-eu/geforce/drivers/

Установить со стандартными настройками (экспресс установка).

Опционально, если драйвер уже установлен, можно обновить до последней версии
из приложения Nvidia или скачав установочный файл по ссылке выше.

### Виртуальное окружение

Создать виртуальное окружение:

`python -m venv venv-train`

Активировать окружение:

`.\venv-train\Scripts\activate.bat`

### Автоматическая установка PyTorch с CUDA

Установить PyTorch сконфигурировов команду, скопировав и запустив её в терминале:

https://pytorch.org/get-started/locally/

Выбрать опции установки:
- PyTorch Build: stable
- Your OS: Windows
- Package: pip
- Language: Python
- Compute platform: CUDA более высокой версии

Пример команды установки:

`pip install torch torchvision --index-url https://download.pytorch.org/whl/cu128`

### Установка ultralytics

Утановить пакет для работы с YOLO:

`pip install ultralytics`


## Аннотирование изображений

### Отдельное виртуальное окружение

Деактивировать виртуальное окружение, если необходимо:

`<папка_текущего_окружения>\Scripts\deactivate.bat`

Создать и активировать новое виртуальное окружение:

`python -m venv venv-annotate`

Активировать окружение:

`.\venv-annotate\Scripts\activate.bat`

### Установка программы для аннотирования

Утановить программу командой:

`pip install digitalsreeni-image-annotator`

### Работа с программой

https://www.youtube.com/watch?v=BupyYUw2boI

1. Создать проект в директории `annotations\<название_проекта>\<название_проекта>.iap`
2. Добавить классы для аннотирования
3. Добавить изображения
4. Аннотировать изображения
5. Выгрузить датасет в формате YOLO: меню _YOLO (beta) > Training > Prepare YOLO Dataset_


<!-- 
## Альтернативная установка: сборка из исходников

### Visual Studio Community
Необходимо для дальнейшей установки CUDA Toolkit. Страница загрузки:
https://visualstudio.microsoft.com/ru/vs/community/
Убрать все галки во вкладке "Рабочие нагрузки". Во вкладке "Отдельные компоненты"
ввести в поле поиска `MSVC x64 последняя версия`, выбрать найденные компоненты.
Нажать "Установить", подтвердить установку без рабочих нагрузок.

### CUDA Toolkit
Выбрать подходящую версию. Должна быть не выше версии, поддерживаемой драйвером и поддерживаться PyTorch.
Скачать версию, выведенную в предыдущем шаге. Если такой нет, скачать более старую:
https://developer.nvidia.com/cuda-toolkit-archive
Установить со стандартными настройками (экспресс установка).
Проверить установку можно командой `nvcc --version`.

### cuDNN - NVIDIA CUDA Deep Neural Network library
Скачать последнюю версию:
https://developer.nvidia.com/cudnn-archive
Установить со стандартными настройками (экспресс установка).

### Инструкции 
https://github.com/pytorch/pytorch#from-source -->